{\rtf1\ansi\ansicpg1252\cocoartf2513
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fswiss\fcharset0 Helvetica;\f1\fnil\fcharset0 HelveticaNeue;\f2\fswiss\fcharset0 ArialMT;
}
{\colortbl;\red255\green255\blue255;\red0\green0\blue0;\red249\green249\blue249;\red17\green143\blue253;
}
{\*\expandedcolortbl;;\cssrgb\c0\c0\c0;\cssrgb\c98039\c98039\c98039;\cssrgb\c0\c63922\c99608;
}
\paperw11900\paperh16840\margl1440\margr1440\vieww10800\viewh8400\viewkind0
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0

\f0\fs24 \cf0 */\
\pard\pardeftab560\slleading20\partightenfactor0

\f1 \cf0 Connection Creation:\
1) Setup->Connection\
2) Create New connection\
3) Choose ZohoOAuth Service\
4) Enter connection name and connection link name\
5) Choose desk related scopes\
6) Create and Connect then replace connection linkname in code instead \'93deskoperation\'94\
*/
\f0 \
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0
\cf0 \
\pard\pardeftab720\sl320\partightenfactor0

\f2\fs28 \cf2 \cb3 \expnd0\expndtw0\kerning0
Agent\'a0Tracker - Must be a Multi Line Text Field\cb1 \
\cb3 Latest Assigned\'a0Time - DATE TIME TYPE Field\cb1 \
\
\cb3 Module : Ticket\cb1 \
\cb3 Argument:\cb1 \
\cb3 Name : ticketID - Value : Ticket Id\cb1 \
\cb3 Name :\'a0teamOwner - Value :\'a0Team\cb1 \
\cb3 Name : agentInfo\'a0- Value : Agent\'a0Tracker\cb1 \
\cb3 Name :\'a0ticketOwner\'a0- Value :\'a0Ticket Owner\cb1 \
\cb3 Name :\'a0oldTime\'a0- Value : Latest Assigned\'a0Time\cb1 \
\
\cb3 Sample Code:\cb1 \
\cb3 ORGID = \'93644\'94088596;\cb1 \
\cb3 createdTime = zoho.currenttime.toString("dd-MM-yyyy HH:mm:ss","GMT+5:30");\cb1 \
\cb3 currentTime = zoho.currenttime.toString("yyyy-MM-dd'T'HH:mm:ss'.000Z'","GMT+5:30");\cb1 \
\cb3 info createdTime;\cb1 \
\cb3 info currentTime;\cb1 \
\cb3 if(oldTime.toString() == "" || oldTime.toString() == null)\cb1 \
\cb3 \{\cb1 \
\cb3 	oldTime = createdTime;\cb1 \
\cb3 \}\cb1 \
\cb3 if(teamOwner != null && teamOwner != "")\cb1 \
\cb3 \{\cb1 \
\cb3 	getTeamInfo = invokeurl\cb1 \
\cb3 	[\cb1 \
\cb3 		url :"{\field{\*\fldinst{HYPERLINK "https://desk.zoho.com/api/v1/teams/"}}{\fldrslt \cf4 https://desk.zoho.com/api/v1/teams/}}" + teamOwner.trim()\cb1 \
\cb3 		type :GET\cb1 \
\cb3 		connection : \'93deskoperation\'94\cb1 \
\cb3 	];\cb1 \
\cb3 	teamName = getTeamInfo.get("name");\cb1 \
\cb3 \}\cb1 \
\cb3 else\cb1 \
\cb3 \{\cb1 \
\cb3 	teamName = "";\cb1 \
\cb3 \}\cb1 \
\cb3 if(ticketOwner == null || ticketOwner == "")\cb1 \
\cb3 \{\cb1 \
\cb3 	ticketOwner = teamName;\cb1 \
\cb3 \}\cb1 \
\cb3 else\cb1 \
\cb3 \{\cb1 \
\cb3 	ticketOwner = teamName + " " + ticketOwner;\cb1 \
\cb3 \}\cb1 \
\cb3 if(agentInfo == null || agentInfo == "")\cb1 \
\cb3 \{\cb1 \
\cb3 	agentInfo = "\\n" + ticketOwner.trim() + " - From : " + oldTime + " - To : " + createdTime;\cb1 \
\cb3 \}\cb1 \
\cb3 else\cb1 \
\cb3 \{\cb1 \
\cb3 	// if(agentInfo.getOccurenceCount(ticketOwner) <= 0)\cb1 \
\cb3 	// \{\cb1 \
\cb3 	agentInfo = agentInfo + ",\\n" + ticketOwner.trim() + " - From : " + oldTime + " - To : " + createdTime;\cb1 \
\cb3 	//\}\cb1 \
\cb3 \}\cb1 \
\cb3 jsonString = \{"cf":\{"cf_agent_tracker":agentInfo,"cf_latest_assigned_time":currentTime\}\};\cb1 \
\cb3 //replace attachmentsLinks with custom multiline text field name\cb1 \
\cb3 info jsonString;\cb1 \
\cb3 UpdateTicket = invokeurl\cb1 \
\cb3 [\cb1 \
\cb3 	url :"{\field{\*\fldinst{HYPERLINK "https://desk.zoho.com/api/v1/tickets/"}}{\fldrslt \cf4 https://desk.zoho.com/api/v1/tickets/}}" + ticketID\cb1 \
\cb3 	type :PATCH\cb1 \
\cb3 	parameters:jsonString + ""\cb1 \
\cb3 	connection : \'93deskoperation\'94\cb1 \
\cb3 ];\cb1 \
\cb3 info UpdateTicket;\cb1 \
}